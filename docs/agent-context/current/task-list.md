# Task List: Epoch 32 Phase 2 (Token Reorganization)

## 1. Exporter Refactoring (`src/lib/exporters/dtcg.ts`)

- [ ] Define `DTCGExport` type to support multi-file output (e.g., `Record<string, DTCGFile>`).
- [ ] Implement `generatePrimitives` function to extract Key Colors and Anchors.
- [ ] Implement `generateSemantics` function (placeholder/schema if needed, or shared constants).
- [ ] Refactor `toDTCG` to orchestrate the generation of `primitives.json`, `light.json`, and `dark.json`.
- [ ] Ensure all color tokens are nested under a `color` top-level group.

## 2. CLI Update (`src/cli/commands/export.ts`)

- [ ] Update `export` command to accept a directory path for `--out`.
- [ ] Implement logic to detect if `--out` is a file (legacy/single-file) or directory (multi-file).
- [ ] If directory, write the multiple files generated by the exporter.
- [ ] Update help text/documentation for the command.

## 3. Verification

- [ ] Run `axiomatic export --out tokens/` and verify the file structure.
- [ ] Inspect `primitives.json` for correct Key Color and Anchor values.
- [ ] Inspect `light.json` and `dark.json` to ensure they reference primitives (where applicable) or contain correct mode values.
- [ ] Verify that the output is valid DTCG JSON.

## 4. Documentation

- [ ] Update `docs/design/token-reorganization.md` with any implementation details or deviations.
- [ ] Update `docs/agent-context/current/walkthrough.md` with the changes.
