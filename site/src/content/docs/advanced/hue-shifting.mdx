---
title: Hue Shifting
---

import DebugVisualizer from "../../../components/DebugVisualizer.svelte";
import DemoWrapper from "../../../components/DemoWrapper.svelte";
import Diagram from "../../../components/Diagram.svelte";
import HueShiftVisualizer from "../../../components/HueShiftVisualizer.svelte";

## Why Shift Hues?

In the real world, objects rarely stay the same hue as they get lighter or darker.

- **Natural Light**: Shadows are often cooler (bluer) due to ambient skylight, while direct highlights are warmer (yellower) from the sun.
- **The Bezold–Brücke Effect**: As light intensity increases, our perception of hue shifts. Reds become yellower, and violets become bluer.

If you create a color palette by simply changing lightness (e.g., `oklch(0.5 0.2 260)` → `oklch(0.9 0.2 260)`), the result can feel "synthetic" or "flat". The shadows might look muddy, or the highlights might look washed out.

**Hue Shifting** mimics natural light physics by rotating the hue as lightness changes. This creates palettes that feel:

1.  **More Dynamic**: Colors feel alive rather than static.
2.  **More Natural**: Mimics the way light interacts with surfaces in the real world.
3.  **More Distinct**: Helps differentiate surfaces that are close in lightness.

<Diagram>
  <div class="docs-grid docs-mb-4">
    <div class="docs-card">
      <strong class="docs-card-header">Static Hue (Boring)</strong>
      <div class="docs-gradient-bar docs-gradient-static"></div>
      <div class="text-subtle docs-mt-2 docs-text-sm">
        Just changing lightness. The result feels mechanical and flat.
      </div>
    </div>
    <div class="docs-card">
      <strong class="docs-card-header">Shifted Hue (Dynamic)</strong>
      <div class="docs-gradient-bar docs-gradient-shifted"></div>
      <div class="text-subtle docs-mt-2 docs-text-sm">
        Rotating hue from Blue (260) to Orange (80) as lightness increases. The
        result feels more vibrant and natural.
      </div>
    </div>
  </div>
</Diagram>

## The Challenge of Linearity

While shifting hues is desirable, _how_ we shift them matters. A naive implementation might apply hue rotation linearly (e.g., 1° of rotation for every 1% of lightness).

However, this linear approach often fails to match human perception or design intent:

1.  **Drifting Shadows**: Deep shadows lose their "cool" base hue too quickly, becoming muddy or ambiguous.
2.  **Premature Warmth**: Highlights become warm too early in the lightness scale, losing the crispness of the mid-tones.

We need a way to "pin" the hue in the shadows and highlights while concentrating the shift in the mid-tones where it adds the most vibrancy.

## The Solution: Cubic Bezier Curves

To solve this, we use a **cubic Bezier curve** to map lightness values (0-1) to hue rotation factors (0-1). This creates an "S-curve" that:

1.  **Starts Slowly**: Keeps the hue stable in the deep shadows.
2.  **Accelerates**: Concentrates the shift in the mid-tones.
3.  **Ends Smoothly**: Stabilizes the hue in the bright highlights.

### Visual Comparison

The table below demonstrates a 180° hue shift (Blue → Orange) applied linearly vs. using a Bezier curve. Notice how the Bezier curve preserves the identity of the colors at the extremes.

<Diagram>
  <div class="docs-grid-comparison-v2">
    <div class="comparison-header">
      <span class="text-subtle">Linear Shift</span>
      <span class="text-subtle">Bezier Shift (S-Curve)</span>
    </div>
    
    {/* Dark (L=0.1) */}
    <div class="comparison-row">
      <div class="row-header">Dark (10%)</div>
      <div class="swatch-pair">
        <div class="swatch-col">
          <div class="docs-swatch docs-swatch-linear-1" title="Linear: +18°"></div>
          <span class="text-xs">Drifts immediately (+18°)</span>
        </div>
        <div class="swatch-col">
          <div class="docs-swatch docs-swatch-bezier-1" title="Bezier: +0°"></div>
          <span class="text-xs">Stays at base hue (+0°)</span>
        </div>
      </div>
    </div>

    {/* Dark-Mid (L=0.3) */}
    <div class="comparison-row">
      <div class="row-header">Shadow (30%)</div>
      <div class="swatch-pair">
        <div class="swatch-col">
          <div class="docs-swatch docs-swatch-linear-2" title="Linear: +54°"></div>
          <span class="text-xs">Significant shift (+54°)</span>
        </div>
        <div class="swatch-col">
          <div class="docs-swatch docs-swatch-bezier-2" title="Bezier: +15°"></div>
          <span class="text-xs">Preserves cool tones (+15°)</span>
        </div>
      </div>
    </div>

    {/* Mid (L=0.5) */}
    <div class="comparison-row">
      <div class="row-header">Mid (50%)</div>
      <div class="swatch-pair">
        <div class="swatch-col">
          <div class="docs-swatch docs-swatch-linear-3" title="Linear: +90°"></div>
          <span class="text-xs">Midpoint (+90°)</span>
        </div>
        <div class="swatch-col">
          <div class="docs-swatch docs-swatch-bezier-3" title="Bezier: +90°"></div>
          <span class="text-xs">Midpoint (+90°)</span>
        </div>
      </div>
    </div>

    {/* Light-Mid (L=0.7) */}
    <div class="comparison-row">
      <div class="row-header">Highlight (70%)</div>
      <div class="swatch-pair">
        <div class="swatch-col">
          <div class="docs-swatch docs-swatch-linear-4" title="Linear: +126°"></div>
          <span class="text-xs">Steady progression (+126°)</span>
        </div>
        <div class="swatch-col">
          <div class="docs-swatch docs-swatch-bezier-4" title="Bezier: +165°"></div>
          <span class="text-xs">Accelerates into warmth (+165°)</span>
        </div>
      </div>
    </div>

    {/* Light (L=0.9) */}
    <div class="comparison-row">
      <div class="row-header">Light (90%)</div>
      <div class="swatch-pair">
        <div class="swatch-col">
          <div class="docs-swatch docs-swatch-linear-5" title="Linear: +162°"></div>
          <span class="text-xs">Not fully rotated (+162°)</span>
        </div>
        <div class="swatch-col">
          <div class="docs-swatch docs-swatch-bezier-5" title="Bezier: +180°"></div>
          <span class="text-xs">Finishes rotation (+180°)</span>
        </div>
      </div>
    </div>

  </div>
</Diagram>

## Interactive Playground

Experiment with the Bezier curve control points to see how they affect the hue shift across the lightness spectrum.

<HueShiftVisualizer
  client:load
  baseHue={260}
  maxRotation={180}
  curve={{ p1: [0.5, 0], p2: [0.5, 1] }}
/>

## Implementation Details

The system uses a standard cubic Bezier function where the curve starts at `(0,0)` and ends at `(1,1)`.

```typescript
function cubicBezier(t: number, p1: number, p2: number): number {
  const oneMinusT = 1 - t;
  return (
    3 * oneMinusT * oneMinusT * t * p1 + 3 * oneMinusT * t * t * p2 + t * t * t
  );
}

export function calculateHueShift(
  lightness: number,
  config?: HueShiftConfig,
): number {
  if (!config) return 0;
  const { curve, maxRotation } = config;
  const factor = cubicBezier(lightness, curve.p1[1], curve.p2[1]);
  return factor * maxRotation;
}
```

### Configuration

You can customize the curve by adjusting the two control points (`p1` and `p2`) and the maximum rotation angle.

```json
{
  "hueShift": {
    "curve": {
      "p1": [0.5, 0], // Control Point 1 (x, y)
      "p2": [0.5, 1] // Control Point 2 (x, y)
    },
    "maxRotation": 180 // Total degrees of rotation
  }
}
```

- **P1**: Controls the "acceleration" out of the shadows. Moving it right delays the shift; moving it up starts the shift earlier.
- **P2**: Controls the "deceleration" into the highlights. Moving it left extends the shift; moving it down ends the shift earlier.

## Related Concepts

- **OKLCH Color Space**: Hue rotations happen in the perceptually uniform OKLCH space, ensuring equal visual impact across the spectrum.
- **Chroma Independence**: Hue shifts don't affect saturation, maintaining consistent vibrancy.
- **CSS `@property`**: Registered custom properties allow smooth animated transitions between hue-shifted values.
